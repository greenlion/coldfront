--disable_query_log
eval INSTALL PLUGIN rapid SONAME 'ha_rapid.so';
--enable_query_log

--echo #
--echo # Basic RAPID secondary engine tests
--echo #

--echo # Create a table with RAPID secondary engine
CREATE TABLE t1 (a INT) SECONDARY_ENGINE RAPID;
SHOW CREATE TABLE t1;

--echo # Load table into RAPID
INSERT INTO t1 VALUES (1), (2), (3);
ALTER TABLE t1 SECONDARY_LOAD;

--echo # Query the table
SET SESSION secondary_engine_cost_threshold = 0;
SELECT * FROM t1 ORDER BY a;
SELECT COUNT(*) FROM t1;

--echo # Unload from RAPID
ALTER TABLE t1 SECONDARY_UNLOAD;

DROP TABLE t1;

--disable_query_log
UNINSTALL PLUGIN rapid;
--enable_query_log
